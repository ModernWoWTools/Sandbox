/*
 * Copyright (C) 2012-2014 Arctium Emulation <http://arctium.org>
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

using Framework.Constants.Misc;
using Framework.Database.Auth.Entities;
using Framework.Logging;
using Framework.Misc;
using System.Collections.Generic;

namespace AuthServer.Managers
{
    class ModuleManager : Singleton<ModuleManager>
    {
        public readonly List<Module> ModuleList;
        public readonly List<Module> Module64List;
        public readonly List<Module> ModuleMacList;

        ModuleManager()
        {
            ModuleList = new List<Module>();
            Module64List = new List<Module>();
            ModuleMacList = new List<Module>();

            UpdateModules();
        }

        public void UpdateModules()
        {
            Log.Message(LogType.Debug, "Loading auth modules...");

            var tp = new Module
            {
                Hash = "36b27cd911b33c61730a8b82c8b2495fd16e8024fc3b2dde08861c77a852941c",
                Type = "auth",
                Size = 512,
                Data = "E716F4F0A01EB9C032A6C1393356A4F766F067949D71023C0CFC0613718966EF814E65CC6EE70C432A7F8AFD8A062B52603A2697E851D231D72C0277614181D713369B1E8E4BEEAB72045A9AAD45F319DB918ECDDB83C8EF8B7510600D391D45E7FEC0BEEAE904A5F9FA620F1CCDAD699D84A4739CE669B5A551831E396214E13B4C88F573F5CDC784CD01530C086B674C03BEB66403A0F87ED17ABBB403DE54CF31BE828A20C566C22E4D4263AA77220B0644D99245345BCAC276EA06925EB984D664725C3CB757140AFE12E27CB996F17159B1057E9B58B78BBB5A139C9FF6215A0D250B75FC9DD435655DDEADCD6CFD84800792C146B3633188ECEB53D2038C185E0BD51A9E6C70FD38ADF530F8DF50FB62053C5E894897AB7DD65C7AC80665F18E7989BE6E30F15E939751123D6D8A44F033175301D15AAAD2AEA06FAC60BA4065846AE938F32B1CB15F16DC0E76792A7332346896048065D17C059899E1D2300E402BD0EA74265DA6A42B1C854E2470D7B21AE4A2DAE90E602A759B2CA0EE610B50D5389DB89335D5451FE76DD85B09FD5297D6F9EFB6C34CE885007F7DF20D6A524E0C3E772FA04B3DD2E014D3A337A790943DAD523CBB5453F4FDF8E74DFE361BD5F25AB31952B478148B570DF5762643F32B994FEC99A747E4A265A66EE84A53509EC285C84679606049314FC526C61B537AC8061C788F8B86F52208"
            };

            ModuleList.Add(tp);

            var pw = new Module
            {
                Hash = "2e6d53adab37a41542b38e01f62cd365eab8805ed0de73c307cc6d9d1dfe478c",
                Type = "auth",
                Size = 321,
                Data = ""
            };

            ModuleList.Add(pw);

            var pw2 = new Module
            {
                Hash = "5e298e530698af905e1247e51ef0b109b352ac310ce7802a1f63613db980ed17",
                Type = "auth",
                Size = 0,
                Data = ""
            };

            ModuleList.Add(pw2);

            // x64
            var tp64 = new Module
            {
                Hash = "c3a1ac0694979e709c3b5486927e558af1e2be02ca96e5615c5a65aacc829226",
                Type = "auth",
                Size = 512,
                Data = "E716F4F0A01EB9C032A6C1393356A4F766F067949D71023C0CFC0613718966EF814E65CC6EE70C432A7F8AFD8A062B52603A2697E851D231D72C0277614181D713369B1E8E4BEEAB72045A9AAD45F319DB918ECDDB83C8EF8B7510600D391D45E7FEC0BEEAE904A5F9FA620F1CCDAD699D84A4739CE669B5A551831E396214E13B4C88F573F5CDC784CD01530C086B674C03BEB66403A0F87ED17ABBB403DE54CF31BE828A20C566C22E4D4263AA77220B0644D99245345BCAC276EA06925EB984D664725C3CB757140AFE12E27CB996F17159B1057E9B58B78BBB5A139C9FF6215A0D250B75FC9DD435655DDEADCD6CFD84800792C146B3633188ECEB53D2038C185E0BD51A9E6C70FD38ADF530F8DF50FB62053C5E894897AB7DD65C7AC80665F18E7989BE6E30F15E939751123D6D8A44F033175301D15AAAD2AEA06FAC60BA4065846AE938F32B1CB15F16DC0E76792A7332346896048065D17C059899E1D2300E402BD0EA74265DA6A42B1C854E2470D7B21AE4A2DAE90E602A759B2CA0EE610B50D5389DB89335D5451FE76DD85B09FD5297D6F9EFB6C34CE885007F7DF20D6A524E0C3E772FA04B3DD2E014D3A337A790943DAD523CBB5453F4FDF8E74DFE361BD5F25AB31952B478148B570DF5762643F32B994FEC99A747E4A265A66EE84A53509EC285C84679606049314FC526C61B537AC8061C788F8B86F52208"
            };

            Module64List.Add(tp64);

            var pw64 = new Module
            {
                Hash = "851c1d2ef926e9b9a345a460874e65517195129b9e3bdec7cc77710fa0b1fad6",
                Type = "auth",
                Size = 321,
                Data = ""
            };

            Module64List.Add(pw64);

            var pw264 = new Module
            {
                Hash = "8c43bda10be33a32abbc09fb2279126c7f5953336391276cff588565332fcd40",
                Type = "auth",
                Size = 0,
                Data = ""
            };

            Module64List.Add(pw264);

            // Mac64
            var tp64m = new Module
            {
                Hash = "b37136b39add83cfdbafa81857de3dd8f15b34e0135ec6cd9c3131d3a578d8c2",
                Type = "auth",
                Size = 512,
                Data = "E716F4F0A01EB9C032A6C1393356A4F766F067949D71023C0CFC0613718966EF814E65CC6EE70C432A7F8AFD8A062B52603A2697E851D231D72C0277614181D713369B1E8E4BEEAB72045A9AAD45F319DB918ECDDB83C8EF8B7510600D391D45E7FEC0BEEAE904A5F9FA620F1CCDAD699D84A4739CE669B5A551831E396214E13B4C88F573F5CDC784CD01530C086B674C03BEB66403A0F87ED17ABBB403DE54CF31BE828A20C566C22E4D4263AA77220B0644D99245345BCAC276EA06925EB984D664725C3CB757140AFE12E27CB996F17159B1057E9B58B78BBB5A139C9FF6215A0D250B75FC9DD435655DDEADCD6CFD84800792C146B3633188ECEB53D2038C185E0BD51A9E6C70FD38ADF530F8DF50FB62053C5E894897AB7DD65C7AC80665F18E7989BE6E30F15E939751123D6D8A44F033175301D15AAAD2AEA06FAC60BA4065846AE938F32B1CB15F16DC0E76792A7332346896048065D17C059899E1D2300E402BD0EA74265DA6A42B1C854E2470D7B21AE4A2DAE90E602A759B2CA0EE610B50D5389DB89335D5451FE76DD85B09FD5297D6F9EFB6C34CE885007F7DF20D6A524E0C3E772FA04B3DD2E014D3A337A790943DAD523CBB5453F4FDF8E74DFE361BD5F25AB31952B478148B570DF5762643F32B994FEC99A747E4A265A66EE84A53509EC285C84679606049314FC526C61B537AC8061C788F8B86F52208"
            };

            ModuleMacList.Add(tp64m);

            var pw64m = new Module
            {
                Hash = "19c91b68752b7826df498bf73aca1103c86962a9a55a0a7033e5ad895f4d927c",
                Type = "auth",
                Size = 321,
                Data = ""
            };

            ModuleMacList.Add(pw64m);

            var pw264m = new Module
            {
                Hash = "1af5418a448f8ad05451e3f7dbb2d9af9cb13458eea2368ebfc539476b954f1c",
                Type = "auth",
                Size = 0,
                Data = ""
            };

            ModuleMacList.Add(pw264m);



            Log.Message(LogType.Debug, "Successfully loaded {0} auth modules", ModuleList.Count);
        }
    }
}
